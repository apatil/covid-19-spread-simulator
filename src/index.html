<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>COVID-19 Interventions Simulation</title>

  <meta name="description" content="COVID-19 Spread Simulator with different intervention strategies. Open source.">
  
  <meta name="twitter:creator" content="@midudev" />
  <meta name="twitter:domain" content="midu.dev" />
  <meta name="twitter:image" content="https://corona-virus-spread-simulator.midudev.now.sh/assets/og.jpg" />
  <meta name="twitter:site" content="@midudev" />
  <meta name="twitter:card" content="summary_large_image" />

  <meta property="og:locale" content="en_EN" />
  <meta property="og:title" content="Coronavirus Spread Simulator ü¶†" />
  <meta property="og:image" content="https://corona-virus-spread-simulator.midudev.now.sh/assets/og.jpg" />
  <meta property="og:description" content="Coronavirus Spread Simulator with different strategies. Open source." />
  <meta property="og:site_name" content="midu.dev" />

  <link rel="canonical" href="https://corona-virus-spread-simulator.midudev.now.sh/">

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link as="script" rel="preload" href="./p5.min.js" />
  <link as="script" rel="modulepreload" href="./app.js" />
  <link as="script" rel="modulepreload" href="./options.js" />
  <link as="script" rel="modulepreload" href="./dom.js" />
  <link as="script" rel="modulepreload" href="./Ball.js" />
  <link as="script" rel="modulepreload" href="./results.js" />
  <link as="script" rel="modulepreload" href="./collisions.js" />
  
  <script defer src="./p5.min.js"></script>
  <script type="module" src="./app.js"></script>
  <style>
    html {
      box-sizing: border-box;
    }
    
    *, *:before, *:after {
      box-sizing: inherit;
    }

    #share {
      position: fixed;
      bottom: 16px;
      right: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 5px 0 0px 5px;
      background: rgba(0, 153, 255, 0.25);
      z-index: 1;
      text-decoration: none;
      font-size: 12px;
      padding: 4px 16px;
      color: #000;
    }

    p {
      margin: 0;
      margin-bottom: 0.75rem;
    }

    #share:hover {
      background: rgba(0, 153, 255, 0.5);
    }

    body {
     font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
      margin: 0 auto;
      width: 360px;
      font-size: 16px;
      line-height: 1.5;
    }

    h1 {
      margin-top: 8px;
      font-size: 24px;
      margin-bottom: 8px;
    }

    main {
      display: flex;
      flex-direction: column;
      width: 100%;
    }

    canvas {
    }
    #defaultCanvas0 {
      border: solid 1px #ddd;
    }

    #graph {
      margin-bottom: 16px;
      transform: scaleY(-1);
    }

    #count {
      width: 100%;
      display: flex;
      flex-wrap: wrap;
    }

    #count div {
      margin-bottom: 8px;
      margin-right: 16px;
      flex: 1 1 0px;
    }

    #count span {
      font-size: 20px;
      font-weight: 800;
    }

    footer {
      padding-bottom: 16px;
      color: #777;
    }

    footer a {
      color: #09f;
    }

    form {
      margin-bottom: 0;
   }

   label {
      font-size: 16px;
      line-height: 32px;
      display: flex;
      align-items: center;
        margin-right: 2ch;
    }
    input {
      margin-left: 0.5ch;
      font-size: 15px;
      display: inline-block;
      height: 30px;
    }
    input[type="text"] {
      width: 5ch;
      padding-left: 0.25ch;
      padding-right: 0.25ch;
    }
    input[type="checkbox"] {
      margin-right: 0.75ch;
    }
    .form-settings {
      background: #efefef;
      padding-left: 1ch;
      padding-right: 1ch;
        padding-top: 0.25rem;
        padding-bottom: 0.25rem;
          margin-bottom: 0.5rem;
    }
    .form-section-label {
      font-size: 14px;
      color: #666;
      text-transform: uppercase;
      line-height: 28px;
      margin-top: 4px;
      letter-spacing: 0.1em;
    }
    .form-section {
      display: flex;
      flex-wrap: wrap;
    }

    #canvas {
      margin: auto;
      padding-bottom: 16px;
      position: relative;
    }

    #replay {
      align-items: center;
      background: rgba(255, 255, 255, .85);
      cursor: pointer;
      display: flex;
      height: 100%;
      font-weight: 500;
      font-size: 21px;
      justify-content: center;
      position: absolute;
      width: 100%;
    }

    #death-count {
      display: none;
    }

    #death-count.show {
      display: block;
    }

   #runnow {
      width: 100%;
        margin-top: 8px;
        margin-bottom: 8px;
        font-size: 16px;
          display: block;
            height: 32px;
    }

    @media (min-width: 800px) {
      body {
       width: 800px;
      }

      h1 {
        font-size: 28px;
      }
    }

  </style>
</head>
<body>
  <!-- <a id="share" href='https://twitter.com/intent/tweet?text=%C2%A1Mira%20en%20este%20simulador%20como%20el%20%23YoMeQuedoEnCasa%20ayuda%20a%20luchar%20el%20%23Coronavirus%20%F0%9F%A6%A0!&url=https%3A%2F%2Fcorona-virus-spread-simulator.midudev.now.sh%2F&via=midudev' rel='noopener nofollow' target='_blank'><svg viewBox="0 0 612 612" width="24"><path d="M612 116.258a250.714 250.714 0 0 1-72.088 19.772c25.929-15.527 45.777-40.155 55.184-69.411-24.322 14.379-51.169 24.82-79.775 30.48-22.907-24.437-55.49-39.658-91.63-39.658-69.334 0-125.551 56.217-125.551 125.513 0 9.828 1.109 19.427 3.251 28.606-104.326-5.24-196.835-55.223-258.75-131.174-10.823 18.51-16.98 40.078-16.98 63.101 0 43.559 22.181 81.993 55.835 104.479a125.556 125.556 0 0 1-56.867-15.756v1.568c0 60.806 43.291 111.554 100.693 123.104-10.517 2.83-21.607 4.398-33.08 4.398-8.107 0-15.947-.803-23.634-2.333 15.985 49.907 62.336 86.199 117.253 87.194-42.947 33.654-97.099 53.655-155.916 53.655-10.134 0-20.116-.612-29.944-1.721 55.567 35.681 121.536 56.485 192.438 56.485 230.948 0 357.188-191.291 357.188-357.188l-.421-16.253c24.666-17.593 46.005-39.697 62.794-64.861z" fill='#1DA1F2' ></path></svg> Compartir</a> -->
  <main>
    <header>
      <h1>COVID-19 Interventions Simulation</h1>
      <div style="font-size: 18px; margin-bottom: 4px;"><strong>Settings</strong></div>

      <div class="form-settings">
      <form>
 
        <div>

          <label aria-label="Baseline R0" title="R0 in the absence of interventions">


            Baseline spread rate (R0): <input id="baseline-r0" type="text" size=5> 
          </label>
        </div>

        <!-- <label aria-label="Gloves %" title="Percent of people who wear gloves">
          <input id="gloves-pct" type="text" size=3>Gloves %
        </label> -->

        <div class="form-section-label">
          <div>Personal Interventions</div>
        </div>
        <div class="form-section">
        <label aria-label="Mask %" title="Percent of people who wear masks">
          Masks: <input id="mask-pct" type="text" size=3>%
        </label>

        <label aria-label="Handwash %" title="Percent of people who wash hands 10x or more per day">
          Handwashing: <input id="handwash-pct" type="text" size=3>%
        </label>

        <!-- <label aria-label="Gown %" title="Percent of people who wear protective gowns">
          <input id="gown-pct" type="text" size=3>Gowns %
        </label> -->

        <label aria-label="N95 %" title="Percent of people who wear N95 masks">
          N95: <input id="n95-pct" type="text" size=3>%
        </label> 
        </div>

      </form>


      <form>

        <div class="form-section-label">
          <div>Social Interventions</div>
        </div>
 
        <div class="form-section">
          <label aria-label="Social Distance %" title="Percent of interactions prevented by social distancing">
            Social Distance: <input id="social-distance-pct" type="text" size=3>%
          </label> 

        <label aria-label="Emergency" title="Impose an emergency lockdown on 85% of the population">
          <input id="emergency-lockdown" type="checkbox"> Lockdown
        </label>
        </div>

        <div class="form-section-label">
          <div>Testing and quarantine</div>
        </div>

        <div class="form-section">
        <label aria-label="Testing Frequency (days)" title="Frequency of random testing">
          Test Frequency: <input id="test-frequency" type="text" size=5 style="margin-right: 0.5ch">days
        </label>


        <label aria-label="Testing Coverage" title="Percent of people who are covered by each random test">
          Testing Coverage: <input id="test-pct" type="text" size=3>%
        </label>
        </div>

      </form>

      <button id="runnow" type="button" class="button">Start the simulation</button>
      </div>

      <div style="font-size: 18px; margin-bottom: 2px;"><strong>Simulation</strong></div>

      <div id="count">
        <div>Healthy<br /><span id="well">0</span></div>
        <div>Recovered<br /><span id="recovered">0</span></div>
        <div>Sick<br /><span id="infected">0</span></div>
        <div>Quarantined<br /><span id="quarantined">0</span></div>
        <!-- <div>Deaths<br /><span id="death">0</span></div> -->
        <div>Max Conc. Sick<br /><span id="max-concurrent-infected">0</span></div>
      </div>

      <svg id="graph" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" height="50" width="100%" aria-labelledby="Graph of virus spread" role="img">
        <title>Graph of virus spread</title>
      </svg>
    </header>
    <section>
      <div id="canvas">
        <div id="replay" style='display: none'>üîÅ Run a new simulation</div>
      </div>
    </section>
  </main>

  <div style="font-size: 18px; margin-bottom: 4px;"><strong>Information</strong></div>

  <p>
    <b>How to use:</b> This is like the <a href='https://www.washingtonpost.com/graphics/2020/world/corona-simulator/'>Washington Post COVID-19 simulator</a> but, in addition to watching the epidemic spread, you can fight it with interventions based on existing technologies (as opposed to vaccines). As noted in <a href=https://www.imperial.ac.uk/media/imperial-college/medicine/sph/ide/gida-fellowships/Imperial-College-COVID19-NPI-modelling-16-03-2020.pdf>Ferguson et al. (2020)</a>, allowing the virus to infect a large fraction of the population would likely lead to tremendous loss of life and overload of health systems. Try to suppress the epidemic without using too many disruptive lockdowns.
  </p>
  <p>
    The simulation currently supports some of the interventions from phases 1 and 2 of the AEI's proposed <a href=https://www.aei.org/wp-content/uploads/2020/03/National-Coronavirus-Response-a-Road-Map-to-Recovering-2.pdf>plan</a> for fighting the pandemic.
  </p>
  <p>
    You can ask a certain percentage of the people in the simulation to wear masks, N95 masks, or to simply wash hands 10 times or more per day. In the real world, please do not buy N95 or other medical-grade masks, or any other medical-grade personal protective equipment, until there is no longer a shortage.
  </p>
  <p>
    You can also require ongoing social distancing. In this simulation, social distancing prevents a given percentage of interactions from happening at all. If things get out of hand, you can impose a lockdown, forcing most people to stay at home.
  </p>
  <p>
    You can also choose to test a certain percentage of people in the simulation for COVID-19 periodically. Anyone who tests positive will go into self-quarantine and will not infect anyone else until they recover.
  </p>
  <p>
    Finally, because we still don't know the exact value of <a href=https://en.wikipedia.org/wiki/Basic_reproduction_number>R0</a> for COVID-19, you can choose a value. R0 is the average number of infections caused by a single primary infection. <a href=https://www.imperial.ac.uk/mrc-global-infectious-disease-analysis/news--wuhan-coronavirus/>Estimates</a> for COVID-19 typically range from 1.5 to 3.5; higher values make the virus harder to fight.
  </p>
  <p>
    <b>What should I take away from this?</b> Qualitative intuition about how mutiple interventions can work together to slow the spread of COVID-19, even if each intervention is not perfect.
  </p>
  <p>
    In particular, handwashing and mask usage add to the effectiveness of other interventions like testing and lockdowns. So, in addition to the other tools we use to fight the virus, we should all be diligent about handwashing and masking. These interventions are more effective if more people use them.
  </p>
  <p>
    <b>What should I not take away from this?</b> This simulation does not make quantitative predictions about the real world. None of the parameters that went into this simulation are known with much certainty for COVID-19. If you find that x% handwashing compliance and y% mask usage is sufficient to prevent the epidemic from spreading in the simulation, it doesn't mean that would be the case in the real world.
  </p>
  <p>
    <b>About the numbers</b> Effectiveness estimates for masks and handwashing more than ten times daily for SARS (not COVID-19) were taken from <a href=https://www.bmj.com/content/336/7635/77.short>Jefferson et al. (2008)</a> whose main results were that "Meta-analysis of six case-control studies suggests that physical measures are highly effective in preventing the spread of SARS: handwashing more than 10 times daily (odds ratio 0.45, 95% confidence interval 0.36 to 0.57; number needed to treat=4, 95% confidence interval 3.65 to 5.52); wearing masks (0.32, 0.25 to 0.40; NNT=6, 4.54 to 8.03); wearing N95 masks (0.09, 0.03 to 0.30; NNT=3, 2.37 to 4.06); wearing gloves (0.43, 0.29 to 0.65; NNT=5, 4.15 to 15.41); wearing gowns (0.23, 0.14 to 0.37; NNT=5, 3.37 to 7.12); and handwashing, masks, gloves, and gowns combined (0.09, 0.02 to 0.35; NNT=3, 2.66 to 4.97)." 
  </p>
  <p>
    To emphasize, these numbers should not be taken as predictive for COVID-19. They were measured for SARS, and also substantial variation was observed between constituent studies. However, they are encouraging.
  </p>
  <p>
    The odds ratios reported were for the study period, not for each potentially infectious contact. Assuming one or more potentially infectious contacts occurred during each study period, the probability of prevention for each would be at least as high as the probability of prevention over the entire study period, since avoiding infection for a study period requires avoiding infection at each contact. Correcting these underestimates would require some (more) modeling assumptions, and for purposes of this simulation I prefer to err on the side of not encouraging inflated hopes about the effectiveness of interventions.
  </p> 
  <p>
    Jefferson et al. recently published a <a href=https://www.medrxiv.org/content/10.1101/2020.03.30.20047217v1.full.pdf>preprint</a> where they find that the efficacy of population-wide mask usage against influenza-like illness is substantially lower than one would expect based on the numbers above. I will need to review the constituent studies of both meta-analyses to determine which numbers are more appropriate for this simulation. I will try to do so quickly. 
  </p>
  <p>
    The number of ticks per 'day' is chosen so that the length of the infectious period is 20 days. So, if you test every 2 days, the infectious period will span ten tests.
  </p>
  <p>
    The simulation is calibrated to give the desired R0 as follows. The collision frequency f for each ball was estimated using the two-dimensional version of the standard collision frequency estimate from statistical mechanics, f = d v œÅ ‚àö2 where d is the diameter of each ball in units of px, œÅ is the number of balls divided by the area in units of px<sup>2</sup> and v is the average speed of all balls in units of px / tick. When an infected ball and a susceptible ball collide, the susceptible ball becomes infected with probability p such that p f T = R0, where T is the length of the infectious period in units of ticks.
  </p>
  <footer>
    Based on <a target="_blank" rel="noopener nofollow" href='https://corona-virus-spread-simulator.midudev.now.sh/'>This Project</a> |¬†<a href='https://github.com/apatil/COVID-19-spread-simulator' target="_blank" rel="noopener nofollow">Source Code</a> | By <a href='https://midu.dev'>@midudev</a> | Modified by Anand Patil and Grant Custer
  </footer>
</body>
</html>
